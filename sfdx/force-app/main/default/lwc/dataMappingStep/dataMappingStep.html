<template>
    <div class="slds-grid">
        <div class="slds-col slds-border_right slds-no-flex" style="width: 210px;">
            <lightning-vertical-navigation selected-item={activeObject} onselect={changeActiveObject} >
                <lightning-vertical-navigation-section label="Stripe Objects">
                    <lightning-vertical-navigation-item label="Customer" name="customer"></lightning-vertical-navigation-item>
                    <lightning-vertical-navigation-item label="Subscription" name="subscription"></lightning-vertical-navigation-item>
                    <lightning-vertical-navigation-item label="Subscription Item" name="subscription-item"></lightning-vertical-navigation-item>
                    <lightning-vertical-navigation-item label="Product" name="product"></lightning-vertical-navigation-item>
                    <lightning-vertical-navigation-item label="Price" name="price"></lightning-vertical-navigation-item>
                </lightning-vertical-navigation-section>
            </lightning-vertical-navigation>
        </div>
        <div class="slds-col slds-p-around_medium">
            <!-- CUSTOMER OBJECT -->
            <template if:true={customerObjectActive}>
                <!-- Mapper Main Content -->
                <h1 class="slds-text-heading_medium">Customer</h1>
                <h4 class="slds-m-top_xx-small slds-m-bottom_small">Salesforce Object: <strong>{defaultSfObject}</strong></h4>
                <p class="slds-m-vertical_small slds-text-color_weak">Customer objects allow you to perform recurring charges, and to track multiple charges, that are associated with the same customer. The API allows you to create, delete, and update your customers. You can retrieve individual customers as well as a list of all your customers.</p>
                <!-- Mapping Groups -->
                <lightning-accordion 
                    active-section-name={defaultCustomerSections}
                    allow-multiple-sections-open>
                    <template for:each={stripeCustomerMappings} for:item="section" for:index="sectionIndex">
                        <lightning-accordion-section name={section.name} label={section.label} key={section.name} data-index={sectionIndex} class="slds-p-vertical_small">
                            <table class="stripe-table_mapping slds-table slds-no-row-hover slds-table_bordered slds-table_cell-buffer">
                                <thead>
                                    <tr class="slds-line-height_reset">
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="">Stripe</div>
                                        </th>
                                        <th class="slds-text-align_center" scope="col">
                                            <div class="slds-truncate" title="">Static</div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="">Salesforce</div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <template for:each={section.fields} for:item="field" for:index="fieldIndex">
                                        <tr key={field.value} data-index={fieldIndex} data-section-name={section.name} data-field-name={field.name}>
                                            <td>
                                                <div class="slds-truncate slds-text-heading_small">{field.name} <span class="slds-badge slds-m-left_xx-small">{field.type}</span></div>
                                                <p class="slds-text-title slds-m-top_x-small">
                                                    <lightning-formatted-rich-text value={field.description}></lightning-formatted-rich-text>
                                                </p>

                                            </td>
                                            <td class="slds-text-align_center">
                                                <div class="slds-is-relative">
                                                    <lightning-input 
                                                        type="toggle" 
                                                        label="Static Value" 
                                                        variant="label-hidden" 
                                                        class="stripe-input_toggle slds-show_inline-block"
                                                        message-toggle-active="" 
                                                        message-toggle-inactive=""
                                                        checked={field.staticValue}
                                                        onchange={toggleStaticValue}>
                                                    </lightning-input>
                                                    <div class="stripe-input__tooltip slds-popover slds-popover_tooltip slds-nubbin_bottom slds-is-absolute" role="tooltip">
                                                        <div class="slds-popover__body">Use Static Value</div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="slds-grid slds-gutters_direct-xx-small">
                                                    <!-- Show Default -->
                                                    <template if:true={field.hasSfValue}>
                                                        <template if:false={field.hasOverride}>
                                                            <div class="slds-col slds-has-flexi-truncate">
                                                                <lightning-input if:true={field.staticValue} type="text" label="Salesforce Value" value={field.sfValue} onchange={updateStaticValueChoice} variant="label-hidden" placeholder="Enter Static Value..."></lightning-input>
                                                                <c-field-picker if:false={field.staticValue} root-object={defaultSfObject} label="Record Type" options={sfFieldOptions} hash={field.sfValue} variant="label-hidden" onselect={updatePicklist} onobjectchange={updateFieldList} onpicklistclick={updatePicklistChoices} searchable placeholder="Select Salesforce Field..."></c-field-picker>
                                                            </div>
                                                        </template>
                                                        <template if:true={field.hasOverride}>
                                                            <div class="slds-col slds-has-flexi-truncate">
                                                                <template if:true={field.staticValue}>
                                                                    <lightning-input type="text" label="Salesforce Value" value={field.sfValue} onchange={updateStaticValueChoice} variant="label-hidden" placeholder="Enter Static Value..."></lightning-input>
                                                                    <div if:true={field.defaultValue} class="slds-text-title slds-m-top_x-small slds-truncate">Default: {field.defaultValue}</div>
                                                                </template>
                                                                <template if:false={field.staticValue}>
                                                                    <c-field-picker root-object={defaultSfObject} label="Record Type" options={sfFieldOptions} hash={field.sfValue} variant="label-hidden" onselect={updatePicklist} onobjectchange={updateFieldList} onpicklistclick={updatePicklistChoices} searchable></c-field-picker>
                                                                    <div if:true={field.defaultValue} class="slds-text-title slds-m-top_x-small slds-truncate">Default: {field.defaultValue}</div>
                                                                </template>
                                                            </div>
                                                            <div class="slds-col slds-no-flex">
                                                                <lightning-button-icon icon-name="utility:skip_back" variant="border-filled" onclick={resetToDefault}></lightning-button-icon>
                                                            </div>
                                                        </template>
                                                    </template>

                                                    <template if:false={field.hasSfValue}>
                                                        <div class="slds-col">
                                                            <lightning-input type="text" label="Default Value" value={field.defaultValue} onfocus={toggleOverride} variant="label-hidden" placeholder="No Default Set"></lightning-input>
                                                        </div>
                                                    </template>
                                                    <!-- Show User Input -->
                                                </div>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </lightning-accordion-section>
                    </template>
                    <lightning-accordion-section name="metadata" label="Metadata">
                        <table class="stripe-table_metadata slds-table slds-no-row-hover slds-table_bordered slds-table_cell-buffer">
                            <thead>
                                <tr class="slds-line-height_reset">
                                    <th class="" scope="col">
                                        <div class="slds-truncate" title="">Stripe</div>
                                    </th>
                                    <th class="slds-text-align_center" scope="col">
                                        Static
                                    </th>
                                    <th class="" scope="col">
                                        <div class="slds-truncate" title="">Salesforce</div>
                                    </th>
                                    <th class="" scope="col">
                                        <!-- Actions -->
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <template if:true={customerMetadataFields.metadataMapping.fields.length}>
                                    <template for:each={customerMetadataFields.metadataMapping.fields} for:item="field" for:index="index">
                                        <tr key={field.description} data-index={index}>
                                            <td>
                                                <div class="slds-truncate">
                                                    <lightning-input type="text" label="Stripe Billing Field" value={field.name} onchange={updateStripeMetadataName} variant="label-hidden"></lightning-input>
                                                </div>
                                            </td>
                                            <td class="slds-text-align_center">
                                                <div class="slds-is-relative">
                                                    <lightning-input 
                                                        type="toggle" 
                                                        label="Static Value" 
                                                        variant="label-hidden" 
                                                        class="stripe-input_toggle slds-show_inline-block"
                                                        message-toggle-active="" 
                                                        message-toggle-inactive=""
                                                        checked={field.staticValue}
                                                        onchange={toggleMetaStaticValue}>
                                                    </lightning-input>
                                                    <div class="stripe-input__tooltip slds-popover slds-popover_tooltip slds-nubbin_bottom slds-is-absolute" role="tooltip">
                                                        <div class="slds-popover__body">Use Static Value</div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <template if:true={field.staticValue}>
                                                    <lightning-input type="text" label="Salesforce Value" value={field.sfValue} onchange={updateMetaStaticValueChoice} variant="label-hidden"></lightning-input>
                                                </template>
                                                <template if:false={field.staticValue}>
                                                    <c-field-picker label="Record Type" root-object={defaultSfObject} options={sfFieldOptions} hash={field.sfValue} variant="label-hidden" onselect={updateMetaPicklist} onobjectchange={updateMetadataFieldList}  searchable placeholder="Select Salesforce Field..."></c-field-picker>
                                                </template>
                                            </td>
                                            <td class="slds-text-align_center">
                                                <lightning-button-icon icon-name="utility:delete" size="small" variant="bare" onclick={removeMetaRow}></lightning-button-icon>
                                            </td>
                                        </tr>
                                    </template>
                                </template>
                                <!-- Empty State -->
                                <template if:false={customerMetadataFields.metadataMapping.fields.length}>
                                    <tr>
                                        <td colspan="4">
                                            <div class="slds-p-around_medium slds-text-align_center slds-text-color_weak">
                                                <em>No metadata fields to show</em>
                                            </div>
                                        </td>
                                    </tr>
                                </template>
                                <!-- /Empty State -->
                            </tbody>
                        </table>
                        <div class="slds-m-top_small">
                            <lightning-button label="Add Custom Field" variant="neutral" icon-name="utility:add" icon-position="left" onclick={addMetadataRow}></lightning-button>
                        </div>
                    </lightning-accordion-section>
                </lightning-accordion>
                <!-- /Mapping Groups -->
            </template>
            <!-- /CUSTOMER OBJECT -->

            <!-- SUBSCRIPTION OBJECT -->
            <template if:true={subscriptionObjectActive}>
                <!-- Mapper Main Content -->
                <h1 class="slds-text-heading_medium">Subscription</h1>
                <h4 class="slds-m-top_xx-small slds-m-bottom_small">Salesforce Object: <strong>{defaultSfObject}</strong></h4>
                <p class="slds-m-vertical_small slds-text-color_weak">Subscriptions allow you to charge a customer on a recurring basis.</p>

                <!-- Mapping Groups -->
                <lightning-accordion 
                    active-section-name={defaultSubscriptionSections}
                    allow-multiple-sections-open>
                    <template for:each={stripeSubscriptionMappings} for:item="section" for:index="sectionIndex">
                        <lightning-accordion-section name={section.name} label={section.label} key={section.name} data-index={sectionIndex} class="slds-p-vertical_small">
                            <table class="stripe-table_mapping slds-table slds-no-row-hover slds-table_bordered slds-table_cell-buffer">
                                <thead>
                                    <tr class="slds-line-height_reset">
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="">Stripe</div>
                                        </th>
                                        <th class="slds-text-align_center" scope="col">
                                            <div class="slds-truncate" title="">Static</div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="">Salesforce</div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <template for:each={section.fields} for:item="field" for:index="fieldIndex">
                                        <tr key={field.value} data-index={fieldIndex} data-section-name={section.name} data-field-name={field.name}>
                                            <td>
                                                <div class="slds-truncate slds-text-heading_small">{field.name} <span class="slds-badge slds-m-left_xx-small">{field.type}</span></div>
                                                <p class="slds-text-title slds-m-top_x-small">
                                                    <lightning-formatted-rich-text value={field.description}></lightning-formatted-rich-text>
                                                </p>
                                            </td>
                                            <td class="slds-text-align_center">
                                                <div class="slds-is-relative">
                                                    <lightning-input 
                                                        type="toggle" 
                                                        label="Static Value" 
                                                        variant="label-hidden" 
                                                        class="stripe-input_toggle slds-show-inline_block"
                                                        message-toggle-active="" 
                                                        message-toggle-inactive=""
                                                        checked={field.staticValue}
                                                        onchange={toggleStaticValue}>
                                                    </lightning-input>
                                                    <div class="stripe-input__tooltip slds-popover slds-popover_tooltip slds-nubbin_bottom slds-is-absolute" role="tooltip">
                                                        <div class="slds-popover__body">Use Static Value</div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="slds-grid slds-gutters_direct-xx-small">
                                                    <!-- Show Default -->
                                                    <template if:true={field.hasSfValue}>
                                                        <template if:false={field.hasOverride}>
                                                            <div class="slds-col slds-has-flexi-truncate">
                                                                <lightning-input if:true={field.staticValue} type="text" label="Salesforce Value" value={field.sfValue} onchange={updateStaticValueChoice} variant="label-hidden" placeholder="Enter Static Value..."></lightning-input>
                                                                <c-field-picker if:false={field.staticValue} label="Record Type" root-object={defaultSfObject} options={sfFieldOptions} hash={field.sfValue} variant="label-hidden" onselect={updatePicklist} onobjectchange={updateFieldList} onpicklistclick={updatePicklistChoices} searchable placeholder="Select Salesforce Field..."></c-field-picker>
                                                            </div>
                                                        </template>
                                                        <template if:true={field.hasOverride}>
                                                            <div class="slds-col slds-has-flexi-truncate">
                                                                <template if:true={field.staticValue}>
                                                                    <lightning-input type="text" label="Salesforce Value" value={field.sfValue} onchange={updateStaticValueChoice} variant="label-hidden" placeholder="Enter Static Value..."></lightning-input>
                                                                    <div if:true={field.defaultValue} class="slds-text-title slds-m-top_x-small slds-truncate">Default: {field.defaultValue}</div>
                                                                </template>
                                                                <template if:false={field.staticValue}>
                                                                    <c-field-picker label="Record Type" root-object={defaultSfObject} options={sfFieldOptions} hash={field.sfValue} variant="label-hidden" onselect={updatePicklist} onobjectchange={updateFieldList} onpicklistclick={updatePicklistChoices} searchable></c-field-picker> 
                                                                    <div if:true={field.defaultValue} class="slds-text-title slds-m-top_x-small slds-truncate">Default: {field.defaultValue}</div>
                                                                </template>
                                                            </div>
                                                            <div class="slds-col slds-no-flex">
                                                                <lightning-button-icon icon-name="utility:skip_back" variant="border-filled" onclick={resetToDefault}></lightning-button-icon>
                                                            </div>
                                                        </template>
                                                    </template>

                                                    <template if:false={field.hasSfValue}>
                                                        <div class="slds-col">
                                                            <lightning-input type="text" label="Default Value" value={field.defaultValue} onfocus={toggleOverride} variant="label-hidden" placeholder="No Default Set"></lightning-input>
                                                        </div>
                                                    </template>
                                                    <!-- Show User Input -->
                                                </div>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </lightning-accordion-section>
                    </template>
                    <lightning-accordion-section name="metadata" label="Metadata">
                        <table class="stripe-table_metadata slds-table slds-no-row-hover slds-table_bordered slds-table_cell-buffer">
                            <thead>
                                <tr class="slds-line-height_reset">
                                    <th class="" scope="col">
                                        <div class="slds-truncate" title="">Stripe</div>
                                    </th>
                                    <th class="slds-text-align_center" scope="col">
                                        Static
                                    </th>
                                    <th class="" scope="col">
                                        <div class="slds-truncate" title="">Salesforce</div>
                                    </th>
                                    <th class="" scope="col">
                                        <!-- Actions -->
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <template if:true={subscriptionMetadataFields.metadataMapping.fields.length}>
                                    <template for:each={subscriptionMetadataFields.metadataMapping.fields} for:item="field" for:index="index">
                                        <tr key={field.description} data-index={index}>
                                            <td>
                                                <div class="slds-truncate">
                                                    <lightning-input type="text" label="Stripe Billing Field" value={field.name} onchange={updateStripeMetadataName} variant="label-hidden"></lightning-input>
                                                </div>
                                            </td>
                                            <td class="slds-text-align_center">
                                                <div class="slds-is-relative">
                                                    <lightning-input 
                                                        type="toggle" 
                                                        label="Static Value" 
                                                        variant="label-hidden" 
                                                        class="stripe-input_toggle slds-show_inline-block"
                                                        message-toggle-active="" 
                                                        message-toggle-inactive=""
                                                        checked={field.staticValue}
                                                        onchange={toggleMetaStaticValue}>
                                                    </lightning-input>
                                                    <div class="stripe-input__tooltip slds-popover slds-popover_tooltip slds-nubbin_bottom slds-is-absolute" role="tooltip">
                                                        <div class="slds-popover__body">Use Static Value</div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <template if:true={field.staticValue}>
                                                    <lightning-input type="text" label="Salesforce Value" value={field.sfValue} onchange={updateMetaStaticValueChoice} variant="label-hidden"></lightning-input>
                                                </template>
                                                <template if:false={field.staticValue}>
                                                    <c-field-picker label="Record Type" root-object={defaultSfObject} options={sfFieldOptions} hash={field.sfValue} variant="label-hidden" onselect={updateMetaPicklist} onobjectchange={updateMetadataFieldList}  searchable placeholder="Select Salesforce Field..."></c-field-picker>
                                                </template>
                                            </td>
                                            <td class="slds-text-align_center">
                                                <lightning-button-icon icon-name="utility:delete" size="small" variant="bare" onclick={removeMetaRow}></lightning-button-icon>
                                            </td>
                                        </tr>
                                    </template>
                                </template>
                                <!-- Empty State -->
                                <template if:false={subscriptionMetadataFields.metadataMapping.fields.length}>
                                    <tr>
                                        <td colspan="4">
                                            <div class="slds-p-around_medium slds-text-align_center slds-text-color_weak">
                                                <em>No metadata fields to show</em>
                                            </div>
                                        </td>
                                    </tr>
                                </template>
                                <!-- /Empty State -->
                            </tbody>
                        </table>
                        <div class="slds-m-top_small">
                            <lightning-button label="Add Custom Field" variant="neutral" icon-name="utility:add" icon-position="left" onclick={addMetadataRow}></lightning-button>
                        </div>
                    </lightning-accordion-section>
                </lightning-accordion>
            </template>
            <!-- /SUBSCRIPTION OBJECT -->

            <!-- SUBSCRIPTION ITEM OBJECT -->
            <template if:true={subscriptionItemObjectActive}>
                <!-- Mapper Main Content -->
                <h1 class="slds-text-heading_medium">Subscription Item</h1>
                <h4 class="slds-m-top_xx-small slds-m-bottom_small">Salesforce Object: <strong>{defaultSfObject}</strong></h4>
                <p class="slds-m-vertical_small slds-text-color_weak">Subscription items allow you to create customer subscriptions with more than one plan, making it easy to represent complex billing relationships.</p>

                <!-- Mapping Groups -->
                <lightning-accordion 
                    active-section-name={defaultSubscriptionItemSections}
                    allow-multiple-sections-open>
                    <template for:each={stripeSubscriptionItemMappings} for:item="section" for:index="sectionIndex">
                        <lightning-accordion-section name={section.name} label={section.label} key={section.name} data-index={sectionIndex} class="slds-p-vertical_small">
                            <table class="stripe-table_mapping slds-table slds-no-row-hover slds-table_bordered slds-table_cell-buffer">
                                <thead>
                                    <tr class="slds-line-height_reset">
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="">Stripe</div>
                                        </th>
                                        <th class="slds-text-align_center" scope="col">
                                            Static
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="">Salesforce</div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <template for:each={section.fields} for:item="field" for:index="fieldIndex">
                                        <tr key={field.value} data-index={fieldIndex} data-section-name={section.name} data-field-name={field.name}>
                                            <td>
                                                <div class="slds-truncate slds-text-heading_small">{field.name} <span class="slds-badge slds-m-left_xx-small">{field.type}</span></div>
                                                <p class="slds-text-title slds-m-top_x-small">
                                                    <lightning-formatted-rich-text value={field.description}></lightning-formatted-rich-text>
                                                </p>
                                            </td>
                                            <td class="slds-text-align_center">
                                                <div class="slds-is-relative">
                                                    <lightning-input 
                                                        type="toggle" 
                                                        label="Static Value" 
                                                        variant="label-hidden" 
                                                        class="stripe-input_toggle slds-show_inline-block"
                                                        message-toggle-active="" 
                                                        message-toggle-inactive=""
                                                        checked={field.staticValue}
                                                        onchange={toggleStaticValue}>
                                                    </lightning-input>
                                                    <div class="stripe-input__tooltip slds-popover slds-popover_tooltip slds-nubbin_bottom slds-is-absolute" role="tooltip">
                                                        <div class="slds-popover__body">Use Static Value</div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="slds-grid slds-gutters_direct-xx-small">
                                                    <!-- Show Default -->
                                                    <template if:true={field.hasSfValue}>
                                                        <template if:false={field.hasOverride}>
                                                            <div class="slds-col slds-has-flexi-truncate">
                                                                <lightning-input if:true={field.staticValue} type="text" label="Salesforce Value" value={field.sfValue} onchange={updateStaticValueChoice} variant="label-hidden" placeholder="Enter Static Value..."></lightning-input>
                                                                <c-field-picker if:false={field.staticValue} label="Record Type" root-object={defaultSfObject} options={sfFieldOptions} hash={field.sfValue} variant="label-hidden" onselect={updatePicklist} onobjectchange={updateFieldList} onpicklistclick={updatePicklistChoices} searchable placeholder="Select Salesforce Field..."></c-field-picker>
                                                            </div>
                                                        </template>
                                                        <template if:true={field.hasOverride}>
                                                            <div class="slds-col slds-has-flexi-truncate">
                                                                <template if:true={field.staticValue}>
                                                                    <lightning-input type="text" label="Salesforce Value" value={field.sfValue} onchange={updateStaticValueChoice} variant="label-hidden" placeholder="Enter Static Value..."></lightning-input>
                                                                    <div if:true={field.defaultValue} class="slds-text-title slds-m-top_x-small slds-truncate">Default: {field.defaultValue}</div>
                                                                </template>
                                                                <template if:false={field.staticValue}>
                                                                    <c-field-picker label="Record Type" root-object={defaultSfObject} options={sfFieldOptions} hash={field.sfValue} variant="label-hidden" onselect={updatePicklist} onobjectchange={updateFieldList} onpicklistclick={updatePicklistChoices} searchable></c-field-picker> 
                                                                    <div if:true={field.defaultValue} class="slds-text-title slds-m-top_x-small slds-truncate">Default: {field.defaultValue}</div>
                                                                </template>
                                                            </div>
                                                            <div class="slds-col slds-no-flex">
                                                                <lightning-button-icon icon-name="utility:skip_back" variant="border-filled" onclick={resetToDefault}></lightning-button-icon>
                                                            </div>
                                                        </template>
                                                    </template>

                                                    <template if:false={field.hasSfValue}>
                                                        <div class="slds-col">
                                                            <lightning-input type="text" label="Default Value" value={field.defaultValue} onfocus={toggleOverride} variant="label-hidden" placeholder="No Default Set"></lightning-input>
                                                        </div>
                                                    </template>
                                                    <!-- Show User Input -->
                                                </div>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </lightning-accordion-section>
                    </template>
                    <lightning-accordion-section name="metadata" label="Metadata">
                        <table class="stripe-table_metadata slds-table slds-no-row-hover slds-table_bordered slds-table_cell-buffer">
                            <thead>
                                <tr class="slds-line-height_reset">
                                    <th class="" scope="col">
                                        <div class="slds-truncate" title="">Stripe</div>
                                    </th>
                                    <th class="slds-text-align_center" scope="col">
                                        Static
                                    </th>
                                    <th class="" scope="col">
                                        <div class="slds-truncate" title="">Salesforce</div>
                                    </th>
                                    <th class="" scope="col">
                                        <!-- Actions -->
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <template if:true={subscriptionItemMetadataFields.metadataMapping.fields.length}>
                                    <template for:each={subscriptionItemMetadataFields.metadataMapping.fields} for:item="field" for:index="index">
                                        <tr key={field.description} data-index={index}>
                                            <td>
                                                <div class="slds-truncate">
                                                    <lightning-input type="text" label="Stripe Billing Field" value={field.name} onchange={updateStripeMetadataName} variant="label-hidden"></lightning-input>
                                                </div>
                                            </td>
                                            <td class="slds-text-align_center">
                                                <div class="slds-is-relative">
                                                    <lightning-input 
                                                        type="toggle" 
                                                        label="Static Value" 
                                                        variant="label-hidden" 
                                                        class="stripe-input_toggle slds-show_inline-block"
                                                        message-toggle-active="" 
                                                        message-toggle-inactive=""
                                                        checked={field.staticValue}
                                                        onchange={toggleMetaStaticValue}>
                                                    </lightning-input>
                                                    <div class="stripe-input__tooltip slds-popover slds-popover_tooltip slds-nubbin_bottom slds-is-absolute" role="tooltip">
                                                        <div class="slds-popover__body">Use Static Value</div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <template if:true={field.staticValue}>
                                                    <lightning-input type="text" label="Salesforce Value" value={field.sfValue} onchange={updateMetaStaticValueChoice} variant="label-hidden"></lightning-input>
                                                </template>
                                                <template if:false={field.staticValue}>
                                                    <c-field-picker label="Record Type" root-object={defaultSfObject} options={sfFieldOptions} hash={field.sfValue} variant="label-hidden" onselect={updateMetaPicklist} onobjectchange={updateMetadataFieldList}  searchable placeholder="Select Salesforce Field..."></c-field-picker>
                                                </template>
                                            </td>
                                            <td class="slds-text-align_center">
                                                <lightning-button-icon icon-name="utility:delete" size="small" variant="bare" onclick={removeMetaRow}></lightning-button-icon>
                                            </td>
                                        </tr>
                                    </template>
                                </template>
                                <!-- Empty State -->
                                <template if:false={subscriptionItemMetadataFields.metadataMapping.fields.length}>
                                    <tr>
                                        <td colspan="4">
                                            <div class="slds-p-around_medium slds-text-align_center slds-text-color_weak">
                                                <em>No metadata fields to show</em>
                                            </div>
                                        </td>
                                    </tr>
                                </template>
                                <!-- /Empty State -->
                            </tbody>
                        </table>
                        <div class="slds-m-top_small">
                            <lightning-button label="Add Custom Field" variant="neutral" icon-name="utility:add" icon-position="left" onclick={addMetadataRow}></lightning-button>
                        </div>
                    </lightning-accordion-section>
                </lightning-accordion>
            </template>
            <!-- /SUBSCRIPTION ITEM OBJECT -->

            <!-- PRODUCT OBJECT -->
            <template if:true={productObjectActive}>
                <!-- Mapper Main Content -->
                <h1 class="slds-text-heading_medium">Product</h1>
                <h4 class="slds-m-top_xx-small slds-m-bottom_small">Salesforce Object: <strong>{defaultSfObject}</strong></h4>
                <p class="slds-m-vertical_small slds-text-color_weak">Products describe the specific goods or services you offer to your customers. For example, you might offer a Standard and Premium version of your goods or service; each version would be a separate Product. They can be used in conjunction with Prices to configure pricing in Checkout and Subscriptions.</p>

                <!-- Mapping Groups -->
                <lightning-accordion 
                    active-section-name={defaultProductSections}
                    allow-multiple-sections-open>
                    <template for:each={stripeProductMappings} for:item="section" for:index="sectionIndex">
                        <lightning-accordion-section name={section.name} label={section.label} key={section.name} data-index={sectionIndex} class="slds-p-vertical_small">
                            <table class="stripe-table_mapping slds-table slds-no-row-hover slds-table_bordered slds-table_cell-buffer">
                                <thead>
                                    <tr class="slds-line-height_reset">
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="">Stripe</div>
                                        </th>
                                        <th class="slds-text-align_center" scope="col">
                                            <div class="slds-truncate" title="">Static</div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="">Salesforce</div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <template for:each={section.fields} for:item="field" for:index="fieldIndex">
                                        <tr key={field.value} data-index={fieldIndex} data-section-name={section.name} data-field-name={field.name}>
                                            <td>
                                                <div class="slds-truncate slds-text-heading_small">{field.name} <span class="slds-badge slds-m-left_xx-small">{field.type}</span></div>
                                                <p class="slds-text-title slds-m-top_x-small">
                                                    <lightning-formatted-rich-text value={field.description}></lightning-formatted-rich-text>
                                                </p>
                                            </td>
                                            <td class="slds-text-align_center">
                                                <div class="slds-is-relative">
                                                    <lightning-input 
                                                        type="toggle" 
                                                        label="Static Value" 
                                                        variant="label-hidden" 
                                                        class="stripe-input_toggle slds-show_inline-block"
                                                        message-toggle-active="" 
                                                        message-toggle-inactive=""
                                                        checked={field.staticValue}
                                                        onchange={toggleStaticValue}>
                                                    </lightning-input>
                                                    <div class="stripe-input__tooltip slds-popover slds-popover_tooltip slds-nubbin_bottom slds-is-absolute" role="tooltip">
                                                        <div class="slds-popover__body">Use Static Value</div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="slds-grid slds-gutters_direct-xx-small">
                                                    <!-- Show Default -->
                                                    <template if:true={field.hasSfValue}>
                                                        <template if:false={field.hasOverride}>
                                                            <div class="slds-col slds-has-flexi-truncate">
                                                                <lightning-input if:true={field.staticValue} type="text" label="Salesforce Value" value={field.sfValue} onchange={updateStaticValueChoice} variant="label-hidden" placeholder="Enter Static Value..."></lightning-input>
                                                                <c-field-picker if:false={field.staticValue} label="Record Type" root-object={defaultSfObject} options={sfFieldOptions} hash={field.sfValue} variant="label-hidden" onselect={updatePicklist} onobjectchange={updateFieldList} onpicklistclick={updatePicklistChoices} searchable placeholder="Select Salesforce Field..."></c-field-picker>
                                                            </div>
                                                        </template>
                                                        <template if:true={field.hasOverride}>
                                                            <div class="slds-col slds-has-flexi-truncate">
                                                                <template if:true={field.staticValue}>
                                                                    <lightning-input type="text" label="Salesforce Value" value={field.sfValue} onchange={updateStaticValueChoice} variant="label-hidden" placeholder="Enter Static Value..."></lightning-input>
                                                                    <div if:true={field.defaultValue} class="slds-text-title slds-m-top_x-small slds-truncate">Default: {field.defaultValue}</div>
                                                                </template>
                                                                <template if:false={field.staticValue}>
                                                                    <c-field-picker label="Record Type" root-object={defaultSfObject} options={sfFieldOptions} hash={field.sfValue} variant="label-hidden" onselect={updatePicklist} onobjectchange={updateFieldList} onpicklistclick={updatePicklistChoices} searchable></c-field-picker> 
                                                                    <div if:true={field.defaultValue} class="slds-text-title slds-m-top_x-small slds-truncate">Default: {field.defaultValue}</div>
                                                                </template>
                                                            </div>
                                                            <div class="slds-col slds-no-flex">
                                                                <lightning-button-icon icon-name="utility:skip_back" variant="border-filled" onclick={resetToDefault}></lightning-button-icon>
                                                            </div>
                                                        </template>
                                                    </template>

                                                    <template if:false={field.hasSfValue}>
                                                        <div class="slds-col">
                                                            <lightning-input type="text" label="Default Value" value={field.defaultValue} onfocus={toggleOverride} variant="label-hidden" placeholder="No Default Set"></lightning-input>
                                                        </div>
                                                    </template>
                                                    <!-- Show User Input -->
                                                </div>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </lightning-accordion-section>
                    </template>
                    <lightning-accordion-section name="metadata" label="Metadata">
                        <table class="stripe-table_metadata slds-table slds-no-row-hover slds-table_bordered slds-table_cell-buffer">
                            <thead>
                                <tr class="slds-line-height_reset">
                                    <th class="" scope="col">
                                        <div class="slds-truncate" title="">Stripe</div>
                                    </th>
                                    <th class="slds-text-align_center" scope="col">
                                        Static
                                    </th>
                                    <th class="" scope="col">
                                        <div class="slds-truncate" title="">Salesforce</div>
                                    </th>
                                    <th class="" scope="col">
                                        <!-- Actions -->
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <template if:true={productMetadataFields.metadataMapping.fields.length}>
                                    <template for:each={productMetadataFields.metadataMapping.fields} for:item="field" for:index="index">
                                        <tr key={field.description} data-index={index}>
                                            <td>
                                                <div class="slds-truncate">
                                                    <lightning-input type="text" label="Stripe Billing Field" value={field.name} onchange={updateStripeMetadataName} variant="label-hidden"></lightning-input>
                                                </div>
                                            </td>
                                            <td class="slds-text-align_center">
                                                <div class="slds-is-relative">
                                                    <lightning-input 
                                                        type="toggle" 
                                                        label="Static Value" 
                                                        variant="label-hidden" 
                                                        class="stripe-input_toggle slds-show_inline-block"
                                                        message-toggle-active="" 
                                                        message-toggle-inactive=""
                                                        checked={field.staticValue}
                                                        onchange={toggleMetaStaticValue}>
                                                    </lightning-input>
                                                    <div class="stripe-input__tooltip slds-popover slds-popover_tooltip slds-nubbin_bottom slds-is-absolute" role="tooltip">
                                                        <div class="slds-popover__body">Use Static Value</div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <template if:true={field.staticValue}>
                                                    <lightning-input type="text" label="Salesforce Value" value={field.sfValue} onchange={updateMetaStaticValueChoice} variant="label-hidden"></lightning-input>
                                                </template>
                                                <template if:false={field.staticValue}>
                                                    <c-field-picker label="Record Type" root-object={defaultSfObject} options={sfFieldOptions} hash={field.sfValue} variant="label-hidden" onselect={updateMetaPicklist} onobjectchange={updateMetadataFieldList}  searchable placeholder="Select Salesforce Field..."></c-field-picker>
                                                </template>
                                            </td>
                                            <td class="slds-text-align_center">
                                                <lightning-button-icon icon-name="utility:delete" size="small" variant="bare" onclick={removeMetaRow}></lightning-button-icon>
                                            </td>
                                        </tr>
                                    </template>
                                </template>
                                <!-- Empty State -->
                                <template if:false={productMetadataFields.metadataMapping.fields.length}>
                                    <tr>
                                        <td colspan="4">
                                            <div class="slds-p-around_medium slds-text-align_center slds-text-color_weak">
                                                <em>No metadata fields to show</em>
                                            </div>
                                        </td>
                                    </tr>
                                </template>
                                <!-- /Empty State -->
                            </tbody>
                        </table>
                        <div class="slds-m-top_small">
                            <lightning-button label="Add Custom Field" variant="neutral" icon-name="utility:add" icon-position="left" onclick={addMetadataRow}></lightning-button>
                        </div>
                    </lightning-accordion-section>
                </lightning-accordion>
            </template>
            <!-- /PRODUCT OBJECT -->

                <!-- PRICE OBJECT -->
                <template if:true={priceObjectActive}>
                <!-- Mapper Main Content -->
                <h1 class="slds-text-heading_medium">Price</h1>
                <h4 class="slds-m-top_xx-small slds-m-bottom_small">Salesforce Object: <strong>{defaultSfObject}</strong></h4>
                <p class="slds-m-vertical_small slds-text-color_weak">Prices define the unit cost, currency, and (optional) billing cycle for both recurring and one-time purchases of products.</p>

                <!-- Mapping Groups -->
                <lightning-accordion 
                    active-section-name={defaultPriceSections}
                    allow-multiple-sections-open>
                    <template for:each={stripePriceMappings} for:item="section" for:index="sectionIndex">
                        <lightning-accordion-section name={section.name} label={section.label} key={section.name} data-index={sectionIndex} class="slds-p-vertical_small">
                            <table class="stripe-table_mapping slds-table slds-no-row-hover slds-table_bordered slds-table_cell-buffer">
                                <thead>
                                    <tr class="slds-line-height_reset">
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="">Stripe</div>
                                        </th>
                                        <th class="slds-text-align_center" scope="col">
                                            <div class="slds-truncate" title="">Static</div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="">Salesforce</div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <template for:each={section.fields} for:item="field" for:index="fieldIndex">
                                        <tr key={field.value} data-index={fieldIndex} data-section-name={section.name} data-field-name={field.name}>
                                            <td>
                                                <div class="slds-truncate slds-text-heading_small">{field.name} <span class="slds-badge slds-m-left_xx-small">{field.type}</span></div>
                                                <p class="slds-text-title slds-m-top_x-small">
                                                    <lightning-formatted-rich-text value={field.description}></lightning-formatted-rich-text>
                                                </p>
                                            </td>
                                            <td class="slds-text-align_center">
                                                <div class="slds-is-relative">
                                                    <lightning-input 
                                                        type="toggle" 
                                                        label="Static Value" 
                                                        variant="label-hidden" 
                                                        class="stripe-input_toggle slds-show_inline-block"
                                                        message-toggle-active="" 
                                                        message-toggle-inactive=""
                                                        checked={field.staticValue}
                                                        onchange={toggleStaticValue}>
                                                    </lightning-input>
                                                    <div class="stripe-input__tooltip slds-popover slds-popover_tooltip slds-nubbin_bottom slds-is-absolute" role="tooltip">
                                                        <div class="slds-popover__body">Use Static Value</div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="slds-grid slds-gutters_direct-xx-small">
                                                    <!-- Show Default -->
                                                    <template if:true={field.hasSfValue}>
                                                        <template if:false={field.hasOverride}>
                                                            <div class="slds-col slds-has-flexi-truncate">
                                                                <lightning-input if:true={field.staticValue} type="text" label="Salesforce Value" value={field.sfValue} onchange={updateStaticValueChoice} variant="label-hidden" placeholder="Enter Static Value..."></lightning-input>
                                                                <c-field-picker if:false={field.staticValue} label="Record Type" root-object={defaultSfObject} options={sfFieldOptions} hash={field.sfValue} variant="label-hidden" onselect={updatePicklist} onobjectchange={updateFieldList} onpicklistclick={updatePicklistChoices} searchable placeholder="Select Salesforce Field..."></c-field-picker>
                                                            </div>
                                                        </template>
                                                        <template if:true={field.hasOverride}>
                                                            <div class="slds-col slds-has-flexi-truncate">
                                                                <template if:true={field.staticValue}>
                                                                    <lightning-input type="text" label="Salesforce Value" value={field.sfValue} onchange={updateStaticValueChoice} variant="label-hidden" placeholder="Enter Static Value..."></lightning-input>
                                                                    <div if:true={field.defaultValue} class="slds-text-title slds-m-top_x-small slds-truncate">Default: {field.defaultValue}</div>
                                                                </template>
                                                                <template if:false={field.staticValue}>
                                                                    <c-field-picker label="Record Type" root-object={defaultSfObject} options={sfFieldOptions} hash={field.sfValue} variant="label-hidden" onselect={updatePicklist} onobjectchange={updateFieldList} onpicklistclick={updatePicklistChoices} searchable></c-field-picker> 
                                                                    <div if:true={field.defaultValue} class="slds-text-title slds-m-top_x-small slds-truncate">Default: {field.defaultValue}</div>
                                                                </template>
                                                            </div>
                                                            <div class="slds-col slds-no-flex">
                                                                <lightning-button-icon icon-name="utility:skip_back" variant="border-filled" onclick={resetToDefault}></lightning-button-icon>
                                                            </div>
                                                        </template>
                                                    </template>

                                                    <template if:false={field.hasSfValue}>
                                                        <div class="slds-col">
                                                            <lightning-input type="text" label="Default Value" value={field.defaultValue} onfocus={toggleOverride} variant="label-hidden" placeholder="No Default Set"></lightning-input>
                                                        </div>
                                                    </template>
                                                    <!-- Show User Input -->
                                                </div>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </lightning-accordion-section>
                    </template>
                    <lightning-accordion-section name="metadata" label="Metadata">
                        <table class="stripe-table_metadata slds-table slds-no-row-hover slds-table_bordered slds-table_cell-buffer">
                            <thead>
                                <tr class="slds-line-height_reset">
                                    <th class="" scope="col">
                                        <div class="slds-truncate" title="">Stripe</div>
                                    </th>
                                    <th class="slds-text-align_center" scope="col">
                                        Static
                                    </th>
                                    <th class="" scope="col">
                                        <div class="slds-truncate" title="">Salesforce</div>
                                    </th>
                                    <th class="" scope="col">
                                        <!-- Actions -->
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <template if:true={priceMetadataFields.metadataMapping.fields.length}>
                                    <template for:each={priceMetadataFields.metadataMapping.fields} for:item="field" for:index="index">
                                        <tr key={field.description} data-index={index}>
                                            <td>
                                                <div class="slds-truncate">
                                                    <lightning-input type="text" label="Stripe Billing Field" value={field.name} onchange={updateStripeMetadataName} variant="label-hidden"></lightning-input>
                                                </div>
                                            </td>
                                            <td class="slds-text-align_center">
                                                <div class="slds-is-relative">
                                                    <lightning-input 
                                                        type="toggle" 
                                                        label="Static Value" 
                                                        variant="label-hidden" 
                                                        class="stripe-input_toggle slds-show_inline-block"
                                                        message-toggle-active="" 
                                                        message-toggle-inactive=""
                                                        checked={field.staticValue}
                                                        onchange={toggleMetaStaticValue}>>
                                                    </lightning-input>
                                                    <div class="stripe-input__tooltip slds-popover slds-popover_tooltip slds-nubbin_bottom slds-is-absolute" role="tooltip">
                                                        <div class="slds-popover__body">Use Static Value</div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <template if:true={field.staticValue}>
                                                    <lightning-input type="text" label="Salesforce Value" value={field.sfValue} onchange={updateMetaStaticValueChoice} variant="label-hidden"></lightning-input>
                                                </template>
                                                <template if:false={field.staticValue}>
                                                    <c-field-picker label="Record Type" root-object={defaultSfObject} options={sfFieldOptions} hash={field.sfValue} variant="label-hidden" onselect={updateMetaPicklist} onobjectchange={updateMetadataFieldList}  searchable placeholder="Select Salesforce Field..."></c-field-picker>
                                                </template>
                                            </td>
                                            <td class="slds-text-align_center">
                                                <lightning-button-icon icon-name="utility:delete" size="small" variant="bare" onclick={removeMetaRow}></lightning-button-icon>
                                            </td>
                                        </tr>
                                    </template>
                                </template>
                                <!-- Empty State -->
                                <template if:false={priceMetadataFields.metadataMapping.fields.length}>
                                    <tr>
                                        <td colspan="4">
                                            <div class="slds-p-around_medium slds-text-align_center slds-text-color_weak">
                                                <em>No metadata fields to show</em>
                                            </div>
                                        </td>
                                    </tr>
                                </template>
                                <!-- /Empty State -->
                            </tbody>
                        </table>
                        <div class="slds-m-top_small">
                            <lightning-button label="Add Custom Field" variant="neutral" icon-name="utility:add" icon-position="left" onclick={addMetadataRow}></lightning-button>
                        </div>
                    </lightning-accordion-section>
                </lightning-accordion>
                <!-- /Mapping Groups -->
            </template>
            <!-- /PRICE OBJECT-->
        </div>
    </div>
</template>